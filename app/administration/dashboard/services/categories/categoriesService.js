(function(){
    'use strict';

    /**
     * This is a sample service
     * Generated by ng-appgen Yeomen/Angular generator.
     *
     * @author: Tapas Jena
     * @copyright: Anitech Consulting Services Pvt Ltd.
     */
    angular.module('administration').factory('categoriesService', function($http, $q, $state, $injector) {

        var factory = {},
            Categories = $injector.get('Categories'),
            categories = {
                loaded: false,
                fetching: true,
                data: {}
            },
            category = {
                loaded: false,
                fetching: true,
                data: {}
            },
            query = {
                order: 'name',
                limit: 10,
                page: 1
            };

        var successCallback = function (success) {
            category.data = success.data;
            console.log(success.data);
        };

        var successCallbackCategory = function (success) {
            categories.data = success.data;
            console.log(success.data);
        };

        var errorCallback = function (error) {
            console.log(error);
        };
        
        factory.getCategories = function () {
            return categories.data.content;
        };

        factory.getCategory = function () {
            return category.data;
        };

        factory.editCategory = function (category) {
            $state.go('dashboard.category',{id: category.id});
        };

        factory.delCategory = function (selected) {

            // Categories.deleteCategory({id: selected[0].id}).then(successCallback,errorCallback);
        };

        factory.getTotalElements = function () {
            return categories.data.totalElements;
        };

        factory.getTotalPages = function () {
            return categories.data.totalPages;
        };

        factory.pagination = function (query) {
            if (query !== undefined) {
                categories.fetching = true;
                Categories.fetchCategories(query).then(successCallback,errorCallback);
            }
        };

        factory.fetchCategories = function () {
            categories.fetching = true;
            Categories.fetchCategories(query).then(successCallbackCategory,errorCallback);
        };

        factory.fetchCategory = function (id) {
            category.fetching = true;
            Categories.fetchCategory(id).then(successCallback,errorCallback);
        };

        factory.deleteCategory = function (id) {
            category.fetching = true;
            Categories.deleteCategory(id).then(successCallback,errorCallback);
        };

        factory.addCategory = function (formData) {
            Categories.addCategory(formData);
        };

        factory.init = function (newMode) {
            categories = {
                loaded: false,
                fetching: true,
                data: {}
            };
            category = {
                loaded: false,
                fetching: true,
                data: {}
            };
            query = {
                order: 'name',
                limit: 5,
                page: 1
            };
        };
        
        return factory;

    });

})();
